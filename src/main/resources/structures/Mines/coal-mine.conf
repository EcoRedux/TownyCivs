Id: coal_mine

Name: Coal Mine

Period: 100

Material: coal
MaxCount: 2
AreaRadius: 5x6x5
SaveEachNTicks: 1

AdditionalTaxAmount: 20
TownUpkeep: 0
InventorySize: 5
TownPointPrice: 2
CustomModelData: 7
Tags: [
  Factory
]

Description: [
  A <gray>coal</gray> mine
  ""
  "<green>Can upgrade to: Advanced Coal Mine</green>"
  "<yellow>Requirements:</yellow>"
  "  - $1000"
  "  - Town Level 2"
  "  - Permission: townycivs.upgrades.mines.coal"
  ""
  "%toco_lore_tickrate%"
  ""
  "%toco_lore_production%"
  "%toco_lore_production_list%"
  ""
  "%toco_lore_banned_biomes%"
  "%toco_lore_banned_biomes_list%"
]

BuyRequirements: [
  {
    Mechanic: permission
    Value: "townycivs.builds.mines.coal"
  }
  {
    Mechanic: price
    Value: 500
  }
]

Production: [
  {
    Mechanic: item
    Value: {
      Items: [
        {
          Material: "minecraft:coal"
          Amount: 10
        }
      ]
    }
  }
]

Upkeep: [
  {
    Mechanic: town_upkeep
    Value: 1
  }
  {
    # Pickaxe requirement - RequireAll: false means ANY ONE pickaxe works (OR logic)
    Mechanic: item_upkeep
    Value: {
      RequireAll: false
      Items: [
        {
          Material: "minecraft:wooden_pickaxe"
          Amount: 1
          ConsumeItem: false
          DamageAmount: 20
        }
        {
          Material: "minecraft:stone_pickaxe"
          Amount: 1
          ConsumeItem: false
          DamageAmount: 15
        }
        {
          Material: "minecraft:iron_pickaxe"
          Amount: 1
          ConsumeItem: false
          DamageAmount: 10
        }
        {
          Material: "minecraft:diamond_pickaxe"
          Amount: 1
          ConsumeItem: false
          DamageAmount: 5
        }
        {
          Material: "minecraft:netherite_pickaxe"
          Amount: 1
          ConsumeItem: false
          DamageAmount: 5
        }
        {
          Material: "minecraft:golden_pickaxe"
          Amount: 1
          ConsumeItem: false
          DamageAmount: 5
        }
      ]
    }
  }
]

# ===== UPGRADE SYSTEM TESTING =====
# This defines what structure this can upgrade TO
UpgradePath: "advanced_coal_mine"

# These are the requirements needed to perform the upgrade
UpgradeRequirements: [
  # TEST CASE 1: Permission requirement
  {
    Mechanic: permission
    Value: "townycivs.upgrades.mines.coal"
  }
  # TEST CASE 2: Price requirement (higher cost to test balance checking)
  {
    Mechanic: price
    Value: 1000
  }
  # TEST CASE 3: Town level requirement
  {
    Mechanic: town_level
    Value: 2
  }
  {
      Mechanic: structure
      Value: "wheat_farm"
  }
]

# Edge cases to test:
# 1. Player without permission - should show red X
# 2. Town without enough money - should show red X
# 3. Town level too low - should show red X
# 4. All requirements met - should show green checkmarks
# 5. Partial requirements met - should show mixed indicators
# 6. No upgrade path defined - button should not appear
# 7. Empty upgrade requirements - should allow upgrade freely
# 8. Null upgrade requirements - should allow upgrade freely

Blocks: {
  "minecraft:cactus": 9
  "tc:fence": 5
  "tc:fence_gate": 1
  "tc:sand": 3
  "!tc:container": 1
}
